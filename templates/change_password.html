{% extends 'layout.html' %}
{% block title %}Change Password{% endblock %}

{% block content %}
<div class="form-container">
    <h1 class="form-title">Change Your Password</h1>
    <form method="post">
        <div class="form-group">
            <label for="old_password">Current Password</label>
            <input type="password" name="old_password" id="old_password" required>
        </div>
        
        <h2 class="form-subtitle" style="font-size: 1.1rem; margin-top: 1.5rem;">Set New Password</h2>
        
        <div class="form-group">
            <label for="new_password">New Password</label>
            <input type="password" name="new_password" id="password" required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters">
        </div>
        <div class="form-group">
            <label for="confirm_new_password">Confirm New Password</label>
            <input type="password" name="confirm_new_password" id="confirm_new_password" required>
        </div>
        
        <!-- Password validation checklist -->
        <div id="password-validation" class="password-reqs">
            <p>Password must contain:</p>
            <ul>
                <li id="length" class="invalid">At least 8 characters</li>
                <li id="lower" class="invalid">A lowercase letter</li>
                <li id="upper" class="invalid">An uppercase letter</li>
                <li id="number" class="invalid">A number</li>
            </ul>
        </div>

        <button type="submit" class="btn" style="margin-top: 1.5rem;">Update Password</button>
    </form>
</div>

<script>
    // JavaScript for real-time password validation
    const passwordInput = document.getElementById('password');
    const length = document.getElementById('length');
    const lower = document.getElementById('lower');
    const upper = document.getElementById('upper');
    const number = document.getElementById('number');

    passwordInput.onkeyup = function() {
        // Validate length
        if(passwordInput.value.length >= 8) {
            length.classList.remove("invalid");
            length.classList.add("valid");
        } else {
            length.classList.remove("valid");
            length.classList.add("invalid");
        }
        // Validate lowercase
        if(passwordInput.value.match(/[a-z]/g)) {
            lower.classList.remove("invalid");
            lower.classList.add("valid");
        } else {
            lower.classList.remove("valid");
            lower.classList.add("invalid");
        }
        // Validate uppercase
        if(passwordInput.value.match(/[A-Z]/g)) {
            upper.classList.remove("invalid");
            upper.classList.add("valid");
        } else {
            upper.classList.remove("valid");
            upper.classList.add("invalid");
        }
        // Validate numbers
        if(passwordInput.value.match(/[0-9]/g)) {
            number.classList.remove("invalid");
            number.classList.add("valid");
        } else {
            number.classList.remove("valid");
            number.classList.add("invalid");
        }
    }
</script>
{% endblock %}
