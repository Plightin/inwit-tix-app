{% extends 'layout.html' %}
{% block title %}My Profile{% endblock %}

{% block content %}
<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="mb-10">
        <h1 class="text-4xl font-extrabold text-gray-800">Hello, {{ current_user.username }}!</h1>
        <p class="text-lg text-gray-500 mt-1">Welcome to your personal dashboard.</p>
    </div>

    <!-- My Tickets -->
    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg mb-10">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">My Purchased Tickets</h2>
        {% if tickets %}
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Event Name</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ticket Type</th>
                            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for ticket in tickets %}
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ ticket.event.name }}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ ticket.ticket_type }}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <a href="{{ url_for('view_ticket', ticket_id=ticket.id) }}" class="btn-primary">View Ticket</a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <p class="text-center text-gray-500 py-8">You haven't purchased any tickets yet.</p>
        {% endif %}
    </div>

    <!-- My Events -->
    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">My Created Events</h2>
        {% if events %}
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Event Name</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date & Venue</th>
                            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for event in events %}
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ event.name }}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ event.event_datetime.strftime('%d %b %Y') }} at {{ event.venue }}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <a href="{{ url_for('event_dashboard', event_id=event.id) }}" class="btn-secondary">View Dashboard</a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <div class="text-center py-8">
                <p class="text-gray-500">You haven't created any events yet.</p>
                <a href="{{ url_for('create_event') }}" class="btn-primary mt-4">Create Your First Event</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
